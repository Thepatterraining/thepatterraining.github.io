<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="YwTcBpc08sCpJAE8mKZglCGHjZc1BiK9UUagC8ldlaA">
  <meta name="msvalidate.01" content="true">
  <meta name="yandex-verification" content="true">
  <meta name="baidu-site-verification" content="3PbJKzlOf0">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"thepatterraining.github.io","root":"/","scheme":"Mist","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="dream">
<meta property="og:url" content="https://thepatterraining.github.io/page/8/index.html">
<meta property="og:site_name" content="dream">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Thepatter">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://thepatterraining.github.io/page/8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>dream</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="dream" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">dream</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">一个菜鸟程序员的成长历程</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://thepatterraining.github.io/nginx%E4%BA%8C.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpeg">
      <meta itemprop="name" content="Thepatter">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dream">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/nginx%E4%BA%8C.html" class="post-title-link" itemprop="url">nginx二 -- 初识nginx</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-08 10:12:47" itemprop="dateCreated datePublished" datetime="2021-10-08T10:12:47+08:00">2021-10-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-26 10:07:53" itemprop="dateModified" datetime="2025-01-26T10:07:53+08:00">2025-01-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nginx/" itemprop="url" rel="index"><span itemprop="name">nginx</span></a>
                </span>
            </span>

          
            <span id="/nginx%E4%BA%8C.html" class="post-meta-item leancloud_visitors" data-flag-title="nginx二 -- 初识nginx" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/nginx%E4%BA%8C.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/nginx%E4%BA%8C.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h1><h2 id="nginx的场景"><a href="#nginx的场景" class="headerlink" title="nginx的场景"></a>nginx的场景</h2><p>三个主要场景</p>
<ul>
<li>静态资源：通过本地文件系统提供服务</li>
<li>反向代理：nginx的强大性能，缓存，负载均衡</li>
<li>API服务：openresty</li>
</ul>
<h2 id="nginx的优点"><a href="#nginx的优点" class="headerlink" title="nginx的优点"></a>nginx的优点</h2><ul>
<li>高并发，高性能</li>
<li>可扩展性好</li>
<li>高可靠性</li>
<li>热部署</li>
<li>BSD许可证</li>
</ul>
<h2 id="nginx的组成"><a href="#nginx的组成" class="headerlink" title="nginx的组成"></a>nginx的组成</h2><ul>
<li>nginx二进制可执行文件：由各模块原码编译出的一个文件</li>
<li>nginx.conf:控制nginx行为</li>
<li>access.log</li>
<li>error.log</li>
</ul>
<h2 id="vim-nginx语法高亮"><a href="#vim-nginx语法高亮" class="headerlink" title="vim nginx语法高亮"></a>vim nginx语法高亮</h2><p>如果想要vim操作nginx的时候有语法高亮，那么只需要把nginx文件夹带的vim配置文件复制到自己的vim配置文件下面就可以了</p>
<p>找到nginx源码目录，注意这里是源码目录，下载的tar包解压出来的目录，而不是编译安装后的目录，下面有一个<code>contrib</code>文件夹，这个文件夹里面有<code>vim</code>文件夹，把这个里面的配置文件都复制一下就好了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -r nginx/contrib/vim/ ~/.vim/</span><br></pre></td></tr></table></figure>

<h2 id="已安装的nginx-增加模块"><a href="#已安装的nginx-增加模块" class="headerlink" title="已安装的nginx 增加模块"></a>已安装的nginx 增加模块</h2><p>首先到达源码目录<code>cd /usr/local/src/nginx1.19</code></p>
<p>然后开始编译</p>
<ul>
<li>–prefix 参数代表你的nginx安装目录，如果是已安装的nginx，那么这个目录就选择已安装的目录，没有安装的可以随便选想安装到的目录</li>
<li>–with 开头的代表你想开启的模块</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./configure --with-file-aio --with-http_ssl_module --with-http_v2_module --with-http_realip_module --prefix=/usr/local/src/nginx</span><br></pre></td></tr></table></figure>

<p>然后执行<code>make</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo make</span><br></pre></td></tr></table></figure>

<p>接下来就可以复制nginx源文件了，这里只执行make，不需要执行make install</p>
<p>现在假设你已经在nginx源码目录了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ./objs  //移动到objs目录下</span><br><span class="line">cp nginx /usr/local/src/nginx/sbin/    //把objs目录下的nginx复制到你原来的nginx安装目录下面的sbin目录替换原来的nginx源文件</span><br></pre></td></tr></table></figure>

<p>如果是新安装，那么不需要复制，直接执行 sudo make install 就可以了</p>
<h2 id="配置语法"><a href="#配置语法" class="headerlink" title="配置语法"></a>配置语法</h2><ul>
<li>配置文件由指令和指令块构成</li>
<li>每条指令以;分号结尾，指令与参数间用空格分隔</li>
<li>指令块以{}大括号将多条指令组织在一起</li>
<li>include 语句允许组合多个配置文件以提升可维护性</li>
<li>使用 #井号添加注释，提高可读性</li>
<li>使用 $符号作为变量</li>
<li>部分指令的参数支持正则表达式</li>
</ul>
<h2 id="http配置的指令块"><a href="#http配置的指令块" class="headerlink" title="http配置的指令块"></a>http配置的指令块</h2><ul>
<li>http</li>
<li>server</li>
<li>upstream</li>
<li>location</li>
</ul>
<h2 id="nginx-命令行"><a href="#nginx-命令行" class="headerlink" title="nginx 命令行"></a>nginx 命令行</h2><ul>
<li>帮助 -h</li>
<li>指定配置文件 -c</li>
<li>指定配置指令 -g</li>
<li>指定运行目录 -p</li>
<li>发送信号 -s</li>
<li>测试配置文件语法 -t</li>
<li>打印版本信息 -v -V</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nginx             //启动</span><br><span class="line">nginx -s reload   // 重启</span><br><span class="line">nginx -s quit    //优雅停止</span><br><span class="line">nginx -s stop    //直接停止</span><br><span class="line">nginx -s reopen  //重新开始记录日志</span><br></pre></td></tr></table></figure>

<h4 id="热部署"><a href="#热部署" class="headerlink" title="热部署"></a>热部署</h4><p>当你需要升级nginx或者增加模块的时候可以使用热部署的方式平滑过渡，不需要重启</p>
<p>查看现在nginx进程的id</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef|grep nginx</span><br></pre></td></tr></table></figure>

<p>对现在的nginx进程发送<code>USR2</code>信号进行热部署</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -USR2 id</span><br></pre></td></tr></table></figure>

<p>现在可以看到新的nginx进程和老的nginx进程都存在了，这个时候我们需要让老的nginx进程平滑退出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -WINCH id</span><br></pre></td></tr></table></figure>

<p>接下来就可以看到老的nginx的worker进程全部平滑退出了，但是老的master进程还在，这是为了防止新的有问题，还可以退回老的</p>
<p>如果接下来新的有问题，那么我们退回老的，发送<code>HUP</code>信号，而不是直接reload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -HUP id</span><br></pre></td></tr></table></figure>

<p>接下来可以看到老的worker进程都起来了</p>
<p>如果热部署后没有问题的话，那么我们直接删除老的master进程就可以了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -QUIT id</span><br></pre></td></tr></table></figure>

<h4 id="日志切割"><a href="#日志切割" class="headerlink" title="日志切割"></a>日志切割</h4><p>如果我们觉得日志太大可以进行日志切割，一种是发送<code>reopen</code>信号，还有一种是发送<code>USR1</code>信号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx -s reopen</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -USR1 id</span><br></pre></td></tr></table></figure>

<p>但是注意切割之前要把之前的日志备份一下，不然就会被删除啦</p>
<h2 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h2><p>反向代理配置在<code>http</code>代码块中</p>
<p>首先通过<code>upstream</code>配置反向代理的服务器</p>
<p>test 是一个名称，可以随便取</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">upstream</span> test&#123;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">127.0.0.1:8080</span>     <span class="comment"># 上游服务器的地址，可以写多个</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过 <code>proxy_pass</code> 进行反向代理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://test;   # 这里填写上面的upstream名字</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候我们访问80端口实际上访问的是8080端口</p>
<h4 id="反向代理的缓存"><a href="#反向代理的缓存" class="headerlink" title="反向代理的缓存"></a>反向代理的缓存</h4><p>反向代理之后还可以在反向代理服务器做缓存</p>
<p>在<code>nginx.conf</code>文件的<code>http</code>代码块中设置缓存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 设置缓存路径 /tmp/nginxCache 缓存名称 my_cache</span><br><span class="line">proxy_cache_path /tmp/nginxCache levels=1:2 keys_zone=my_cache:10m max_size=10g inactive=60m use_temp_path=off;</span><br></pre></td></tr></table></figure>

<p>接下来在我们的反向代理<code>server/location</code>代码块里面使用这个缓存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    proxy_cache my_cache;   # 使用上面定义的缓存</span><br><span class="line">    proxy_cache_key $host$uri$is_args$args;  # 缓存的key值，根据host uri和参数来做key</span><br><span class="line">    proxy_cache_valid 200 304 302 1d;   # 缓存200 304 302状态 缓存时间1d = 1天</span><br><span class="line">    proxy_pass http://test;   # 这里填写上面的upstream名字</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="goaccess-日志可视化"><a href="#goaccess-日志可视化" class="headerlink" title="goaccess 日志可视化"></a>goaccess 日志可视化</h2><p>goaccess 是一个c语言写的日志可视化工具</p>
<p>直接编译安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://tar.goaccess.io/goaccess-1.2.tar.gz</span><br><span class="line">tar -xzvf goaccess-1.2.tar.gz</span><br><span class="line">cd goaccess-1.2/</span><br><span class="line">./configure --enable-utf8</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p>然后就可以启动了，直接启动就可以</p>
<p>指定日志文件路径 <code>/usr/local/src/nginx/logs/access.log</code> -o 输出到某个html文件中 –real-time-html 代表实时刷新, –log-format 代表日志格式 ，–daemonize 代表守护进程后台执行 仅在 开启了 –real-time-html 实时刷新有效</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">goaccess /usr/local/src/nginx/logs/access.log -o ~/wwwroot/goaccess.html --real-time-html --log-format=COMBINED --daemonize</span><br></pre></td></tr></table></figure>

<p>这里要注意，如果开启了  –real-time-html 实时刷新，那么会启动一个 socket 进程监听 7890 端口，所以 7890 端口要开放才行</p>
<p>可以配置 nginx 文件访问这个输出的 html 文件了，就可以看到一个可视化界面了</p>
<h2 id="ssl"><a href="#ssl" class="headerlink" title="ssl"></a>ssl</h2><p>ssl(Secure Sosckets Layer)<br>tls(Transport Layer Security)</p>
<ul>
<li>1995年-ssl3.0</li>
<li>1999 - tls1.0</li>
<li>2006 - tls1.1</li>
<li>2008 - tls1.2</li>
<li>2018 - tls1.3</li>
</ul>
<p>ssl&#x2F;tls 运行在 <code>ISO7层模型的表示层中</code>，而http协议运行在表示层的上层<code>应用层</code>。在http的数据传输到<code>表示层</code>以后，ssl&#x2F;tls就会对数据进行加密</p>
<ul>
<li>握手</li>
<li>交换秘钥</li>
<li>告警</li>
<li>对称加密的应用数据</li>
</ul>
<p>tls安全套件</p>
<blockquote>
<p>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</p>
</blockquote>
<ul>
<li>tls代表tls加密</li>
<li>ECDHE 代表秘钥交换算法</li>
<li>RSA 代表身份验证算法</li>
<li>AES 代表对称加密算法</li>
<li>128 代表强度</li>
<li>GCM 代表分组模式</li>
<li>SHA256 代表签名 hash 算法</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://thepatterraining.github.io/nginx%E4%B8%80.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpeg">
      <meta itemprop="name" content="Thepatter">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dream">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/nginx%E4%B8%80.html" class="post-title-link" itemprop="url">nginx一 -- 初识nginx</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-04 10:12:47" itemprop="dateCreated datePublished" datetime="2021-10-04T10:12:47+08:00">2021-10-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-26 10:07:53" itemprop="dateModified" datetime="2025-01-26T10:07:53+08:00">2025-01-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nginx/" itemprop="url" rel="index"><span itemprop="name">nginx</span></a>
                </span>
            </span>

          
            <span id="/nginx%E4%B8%80.html" class="post-meta-item leancloud_visitors" data-flag-title="nginx一 -- 初识nginx" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/nginx%E4%B8%80.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/nginx%E4%B8%80.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h1><h2 id="nginx的场景"><a href="#nginx的场景" class="headerlink" title="nginx的场景"></a>nginx的场景</h2><p>三个主要场景</p>
<ul>
<li>静态资源：通过本地文件系统提供服务</li>
<li>反向代理：nginx的强大性能，缓存，负载均衡</li>
<li>API服务：openresty</li>
</ul>
<h2 id="nginx的优点"><a href="#nginx的优点" class="headerlink" title="nginx的优点"></a>nginx的优点</h2><ul>
<li>高并发，高性能</li>
<li>可扩展性好</li>
<li>高可靠性</li>
<li>热部署</li>
<li>BSD许可证</li>
</ul>
<h2 id="nginx的组成"><a href="#nginx的组成" class="headerlink" title="nginx的组成"></a>nginx的组成</h2><ul>
<li>nginx二进制可执行文件：由各模块原码编译出的一个文件</li>
<li>nginx.conf:控制nginx行为</li>
<li>access.log</li>
<li>error.log</li>
</ul>
<h2 id="vim-nginx语法高亮"><a href="#vim-nginx语法高亮" class="headerlink" title="vim nginx语法高亮"></a>vim nginx语法高亮</h2><p>如果想要vim操作nginx的时候有语法高亮，那么只需要把nginx文件夹带的vim配置文件复制到自己的vim配置文件下面就可以了</p>
<p>找到nginx源码目录，注意这里是源码目录，下载的tar包解压出来的目录，而不是编译安装后的目录，下面有一个<code>contrib</code>文件夹，这个文件夹里面有<code>vim</code>文件夹，把这个里面的配置文件都复制一下就好了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -r nginx/contrib/vim/ ~/.vim/</span><br></pre></td></tr></table></figure>

<h2 id="已安装的nginx-增加模块"><a href="#已安装的nginx-增加模块" class="headerlink" title="已安装的nginx 增加模块"></a>已安装的nginx 增加模块</h2><p>首先到达源码目录<code>cd /usr/local/src/nginx1.19</code></p>
<p>然后开始编译</p>
<ul>
<li>–prefix 参数代表你的nginx安装目录，如果是已安装的nginx，那么这个目录就选择已安装的目录，没有安装的可以随便选想安装到的目录</li>
<li>–with 开头的代表你想开启的模块</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./configure --with-file-aio --with-http_ssl_module --with-http_v2_module --with-http_realip_module --prefix=/usr/local/src/nginx</span><br></pre></td></tr></table></figure>

<p>然后执行<code>make</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo make</span><br></pre></td></tr></table></figure>

<p>接下来就可以复制nginx源文件了，这里只执行make，不需要执行make install</p>
<p>现在假设你已经在nginx源码目录了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ./objs  //移动到objs目录下</span><br><span class="line">cp nginx /usr/local/src/nginx/sbin/    //把objs目录下的nginx复制到你原来的nginx安装目录下面的sbin目录替换原来的nginx源文件</span><br></pre></td></tr></table></figure>

<p>如果是新安装，那么不需要复制，直接执行 sudo make install 就可以了</p>
<h2 id="配置语法"><a href="#配置语法" class="headerlink" title="配置语法"></a>配置语法</h2><ul>
<li>配置文件由指令和指令块构成</li>
<li>每条指令以;分号结尾，指令与参数间用空格分隔</li>
<li>指令块以{}大括号将多条指令组织在一起</li>
<li>include 语句允许组合多个配置文件以提升可维护性</li>
<li>使用 #井号添加注释，提高可读性</li>
<li>使用 $符号作为变量</li>
<li>部分指令的参数支持正则表达式</li>
</ul>
<h2 id="http配置的指令块"><a href="#http配置的指令块" class="headerlink" title="http配置的指令块"></a>http配置的指令块</h2><ul>
<li>http</li>
<li>server</li>
<li>upstream</li>
<li>location</li>
</ul>
<h2 id="nginx-命令行"><a href="#nginx-命令行" class="headerlink" title="nginx 命令行"></a>nginx 命令行</h2><ul>
<li>帮助 -h</li>
<li>指定配置文件 -c</li>
<li>指定配置指令 -g</li>
<li>指定运行目录 -p</li>
<li>发送信号 -s</li>
<li>测试配置文件语法 -t</li>
<li>打印版本信息 -v -V</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nginx             //启动</span><br><span class="line">nginx -s reload   // 重启</span><br><span class="line">nginx -s quit    //优雅停止</span><br><span class="line">nginx -s stop    //直接停止</span><br><span class="line">nginx -s reopen  //重新开始记录日志</span><br></pre></td></tr></table></figure>

<h4 id="热部署"><a href="#热部署" class="headerlink" title="热部署"></a>热部署</h4><p>当你需要升级nginx或者增加模块的时候可以使用热部署的方式平滑过渡，不需要重启</p>
<p>查看现在nginx进程的id</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef|grep nginx</span><br></pre></td></tr></table></figure>

<p>对现在的nginx进程发送<code>USR2</code>信号进行热部署</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -USR2 id</span><br></pre></td></tr></table></figure>

<p>现在可以看到新的nginx进程和老的nginx进程都存在了，这个时候我们需要让老的nginx进程平滑退出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -WINCH id</span><br></pre></td></tr></table></figure>

<p>接下来就可以看到老的nginx的worker进程全部平滑退出了，但是老的master进程还在，这是为了防止新的有问题，还可以退回老的</p>
<p>如果接下来新的有问题，那么我们退回老的，发送<code>HUP</code>信号，而不是直接reload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -HUP id</span><br></pre></td></tr></table></figure>

<p>接下来可以看到老的worker进程都起来了</p>
<p>如果热部署后没有问题的话，那么我们直接删除老的master进程就可以了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -QUIT id</span><br></pre></td></tr></table></figure>

<h4 id="日志切割"><a href="#日志切割" class="headerlink" title="日志切割"></a>日志切割</h4><p>如果我们觉得日志太大可以进行日志切割，一种是发送<code>reopen</code>信号，还有一种是发送<code>USR1</code>信号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx -s reopen</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -USR1 id</span><br></pre></td></tr></table></figure>

<p>但是注意切割之前要把之前的日志备份一下，不然就会被删除啦</p>
<h2 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h2><p>反向代理配置在<code>http</code>代码块中</p>
<p>首先通过<code>upstream</code>配置反向代理的服务器</p>
<p>test 是一个名称，可以随便取</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">upstream</span> test&#123;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">127.0.0.1:8080</span>     <span class="comment"># 上游服务器的地址，可以写多个</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过 <code>proxy_pass</code> 进行反向代理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://test;   # 这里填写上面的upstream名字</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候我们访问80端口实际上访问的是8080端口</p>
<h4 id="反向代理的缓存"><a href="#反向代理的缓存" class="headerlink" title="反向代理的缓存"></a>反向代理的缓存</h4><p>反向代理之后还可以在反向代理服务器做缓存</p>
<p>在<code>nginx.conf</code>文件的<code>http</code>代码块中设置缓存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 设置缓存路径 /tmp/nginxCache 缓存名称 my_cache</span><br><span class="line">proxy_cache_path /tmp/nginxCache levels=1:2 keys_zone=my_cache:10m max_size=10g inactive=60m use_temp_path=off;</span><br></pre></td></tr></table></figure>

<p>接下来在我们的反向代理<code>server/location</code>代码块里面使用这个缓存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    proxy_cache my_cache;   # 使用上面定义的缓存</span><br><span class="line">    proxy_cache_key $host$uri$is_args$args;  # 缓存的key值，根据host uri和参数来做key</span><br><span class="line">    proxy_cache_valid 200 304 302 1d;   # 缓存200 304 302状态 缓存时间1d = 1天</span><br><span class="line">    proxy_pass http://test;   # 这里填写上面的upstream名字</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="goaccess-日志可视化"><a href="#goaccess-日志可视化" class="headerlink" title="goaccess 日志可视化"></a>goaccess 日志可视化</h2><p>goaccess 是一个c语言写的日志可视化工具</p>
<p>直接编译安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://tar.goaccess.io/goaccess-1.2.tar.gz</span><br><span class="line">tar -xzvf goaccess-1.2.tar.gz</span><br><span class="line">cd goaccess-1.2/</span><br><span class="line">./configure --enable-utf8</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p>然后就可以启动了，直接启动就可以</p>
<p>指定日志文件路径 <code>/usr/local/src/nginx/logs/access.log</code> -o 输出到某个html文件中 –real-time-html 代表实时刷新, –log-format 代表日志格式 ，–daemonize 代表守护进程后台执行 仅在 开启了 –real-time-html 实时刷新有效</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">goaccess /usr/local/src/nginx/logs/access.log -o ~/wwwroot/goaccess.html --real-time-html --log-format=COMBINED --daemonize</span><br></pre></td></tr></table></figure>

<p>这里要注意，如果开启了  –real-time-html 实时刷新，那么会启动一个 socket 进程监听 7890 端口，所以 7890 端口要开放才行</p>
<p>可以配置 nginx 文件访问这个输出的 html 文件了，就可以看到一个可视化界面了</p>
<h2 id="ssl"><a href="#ssl" class="headerlink" title="ssl"></a>ssl</h2><p>ssl(Secure Sosckets Layer)<br>tls(Transport Layer Security)</p>
<ul>
<li>1995年-ssl3.0</li>
<li>1999 - tls1.0</li>
<li>2006 - tls1.1</li>
<li>2008 - tls1.2</li>
<li>2018 - tls1.3</li>
</ul>
<p>ssl&#x2F;tls 运行在 <code>ISO7层模型的表示层中</code>，而http协议运行在表示层的上层<code>应用层</code>。在http的数据传输到<code>表示层</code>以后，ssl&#x2F;tls就会对数据进行加密</p>
<ul>
<li>握手</li>
<li>交换秘钥</li>
<li>告警</li>
<li>对称加密的应用数据</li>
</ul>
<p>tls安全套件</p>
<blockquote>
<p>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</p>
</blockquote>
<ul>
<li>tls代表tls加密</li>
<li>ECDHE 代表秘钥交换算法</li>
<li>RSA 代表身份验证算法</li>
<li>AES 代表对称加密算法</li>
<li>128 代表强度</li>
<li>GCM 代表分组模式</li>
<li>SHA256 代表签名 hash 算法</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://thepatterraining.github.io/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpeg">
      <meta itemprop="name" content="Thepatter">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dream">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0.html" class="post-title-link" itemprop="url">学堂在线C++程序设计第十四章学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-01 10:12:47" itemprop="dateCreated datePublished" datetime="2021-09-01T10:12:47+08:00">2021-09-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-26 10:07:53" itemprop="dateModified" datetime="2025-01-26T10:07:53+08:00">2025-01-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
            </span>

          
            <span id="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0.html" class="post-meta-item leancloud_visitors" data-flag-title="学堂在线C++程序设计第十四章学习笔记" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="学堂在线C-程序设计第十四章学习笔记"><a href="#学堂在线C-程序设计第十四章学习笔记" class="headerlink" title="学堂在线C++程序设计第十四章学习笔记"></a>学堂在线C++程序设计第十四章学习笔记</h1><h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="comment">//抛出异常</span></span><br><span class="line">&#125; <span class="built_in">catch</span> (异常) &#123;</span><br><span class="line">    <span class="comment">//异常处理</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>异常接口声明</p>
<ul>
<li>一个函数显式声明可能抛出的异常，有利于函数的调用者为异常处理做好准备</li>
<li>void fun() throw(A,B,C)</li>
<li>若无异常接口声明，则可以抛出任何类型的异常</li>
<li>不抛任何类型异常的函数声明如下：<br>  void fun() throw()</li>
</ul>
<h3 id="异常处理的构造与析构"><a href="#异常处理的构造与析构" class="headerlink" title="异常处理的构造与析构"></a>异常处理的构造与析构</h3><p>自动的析构</p>
<ul>
<li>找到一个匹配的catch异常处理后</li>
<li>初始化异常参数</li>
<li>将从对应的try块开始到异常被抛出之间构造（且尚未析构）的所有自动对象进行析构</li>
<li>从最后一个catch处理之后开始恢复执行</li>
</ul>
<h3 id="标准程序库异常处理"><a href="#标准程序库异常处理" class="headerlink" title="标准程序库异常处理"></a>标准程序库异常处理</h3><p>基础</p>
<ul>
<li>exception</li>
<li>logic_error 表示可以被预先检测到的异常<ul>
<li>这类异常可以避免</li>
</ul>
</li>
<li>runtime_error 表示难以被预先检测到的异常</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://thepatterraining.github.io/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpeg">
      <meta itemprop="name" content="Thepatter">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dream">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0.html" class="post-title-link" itemprop="url">学堂在线C++程序设计第十三章学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-31 10:12:47" itemprop="dateCreated datePublished" datetime="2021-08-31T10:12:47+08:00">2021-08-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-26 10:07:53" itemprop="dateModified" datetime="2025-01-26T10:07:53+08:00">2025-01-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
            </span>

          
            <span id="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0.html" class="post-meta-item leancloud_visitors" data-flag-title="学堂在线C++程序设计第十三章学习笔记" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="学堂在线C-程序设计第十三章学习笔记"><a href="#学堂在线C-程序设计第十三章学习笔记" class="headerlink" title="学堂在线C++程序设计第十三章学习笔记"></a>学堂在线C++程序设计第十三章学习笔记</h1><h2 id="流类库与输入输出"><a href="#流类库与输入输出" class="headerlink" title="流类库与输入输出"></a>流类库与输入输出</h2><h3 id="IO流的概念"><a href="#IO流的概念" class="headerlink" title="IO流的概念"></a>IO流的概念</h3><p>当程序与外界环境进行信息交换时，存在着两个对象，一个是程序中的对象，另一个是文件对象</p>
<p><code>流</code>是信息流动的抽象，负责在数据的<code>生产者</code>和<code>消费者</code>之间建立联系，并管理数据的流动</p>
<p>流对象与文件操作</p>
<ul>
<li>建立流对象</li>
<li>指定这个流对象与某个文件对象建立连接</li>
<li>程序操作流对象</li>
<li>流对象通过文件系统对所连接的文件对象产生作用</li>
</ul>
<p>提取与插入</p>
<ul>
<li>读操作从流中提取</li>
<li>写操作向流中写入</li>
</ul>
<h3 id="输出流"><a href="#输出流" class="headerlink" title="输出流"></a>输出流</h3><p>最重要的三个输出流</p>
<ul>
<li>ostream</li>
<li>ofstream</li>
<li>ostringstream</li>
</ul>
<p>预先定义的输出流对象</p>
<ul>
<li>cout 标准输出</li>
<li>cerr 标准错误输出，没有缓冲，发送给它的内容立即被输出</li>
<li>clog 类似cerr，但是有缓冲，缓冲区满时被输出</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ofstream <span class="title">fout</span><span class="params">(<span class="string">&#x27;123.log&#x27;</span>)</span></span>;</span><br><span class="line">streamBuf* old = cout.<span class="built_in">rdbuf</span>(fout.<span class="built_in">rdbuf</span>());</span><br><span class="line"><span class="comment">//cout 输出到123.log文件</span></span><br><span class="line">cout.<span class="built_in">rdbuf</span>(old); <span class="comment">//恢复输出到标准输出</span></span><br></pre></td></tr></table></figure>

<p>构造输出流对象</p>
<ul>
<li>ofstream 类支持磁盘文件输出</li>
<li>如果在构造函数中指定文件名，当构造这个文件时该文件时自动打开的<br>  ofstream fout(‘123.log’);</li>
<li>可以在调用默认构造函数后使用open打开文件<br>  ofstream fout;<br>  fout.open(123.log);</li>
<li>打开文件可以指定模式<br>  ofstream fout(‘123.log’, ios_base::out|ios_base::binary);</li>
</ul>
<p>文件输出流成员函数的三种类型</p>
<ul>
<li>与操纵符等价的成员函数</li>
<li>执行非格式化写操作的成员函数</li>
<li>其他修改流状态且不同于操纵符或插入运算符的成员函数</li>
</ul>
<p>成员函数</p>
<ul>
<li>open<ul>
<li>把流与磁盘文件关联</li>
<li>需要指定打开模式</li>
</ul>
</li>
<li>put<ul>
<li>把一个字符写到输出流</li>
</ul>
</li>
<li>write<ul>
<li>将内存中的一块内容写到一个文件输出，可以写二进制</li>
</ul>
</li>
<li>seekp和 tellp<ul>
<li>操作文件流的内部指针</li>
</ul>
</li>
<li>close<ul>
<li>关闭磁盘文件</li>
</ul>
</li>
<li>错误处理函数<ul>
<li>在写到一个流时进行错误处理</li>
</ul>
</li>
</ul>
<h4 id="向文本文件输出"><a href="#向文本文件输出" class="headerlink" title="向文本文件输出"></a>向文本文件输出</h4><p>插入运算符 &lt;&lt;</p>
<ul>
<li>为所有标准C++数据类型设计的，用于传送一个字节到输出流对象</li>
</ul>
<p>操纵符（manipulator）</p>
<ul>
<li>插入运算符和操纵符一起<br>  控制输出格式</li>
<li>很多操纵符都定义在 ios_base类中，如hex()，<iomanip>头文件中，如setprecision()</li>
<li>控制输出宽度<br>  在流中放入setw操纵符或调用width成员函数</li>
<li>setw和 width只影响紧随其后的输出项，但其他流格式操纵符保持有效直到发生改变</li>
<li>dec,oct和 hex操纵符设置输入输出的默认进制</li>
</ul>
<p>精度</p>
<ul>
<li>浮点数输出精度的默认值是6</li>
<li>改变精度使用 setprecision操纵符，定义在 <iomanip> 头文件中</li>
<li>如果不指定 fixed 或 scientifc,精度值表示有效数字位数</li>
<li>如果设置了 ios_base::fixed 定点形式 或 ios_base::scientifc 科学计数法 ，精度值表示小数点之后的位数</li>
</ul>
<h4 id="向二进制文件输出"><a href="#向二进制文件输出" class="headerlink" title="向二进制文件输出"></a>向二进制文件输出</h4><p>二进制文件流</p>
<ul>
<li>使用ofstream构造函数中的模式指定二进制</li>
<li>以通常方式构造一个流，然后使用setmode成员函数，在文件打开后改变模式</li>
<li>通过二进制文件输出流对象完成输出</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> b[<span class="number">3</span>] =&#123;<span class="number">912</span>,<span class="number">2456</span>,<span class="number">37890</span>&#125;;</span><br><span class="line">    <span class="function">ofstream <span class="title">file</span><span class="params">(<span class="string">&quot;date.bat&quot;</span>, ios_base::binary)</span></span>;</span><br><span class="line">    file.<span class="built_in">write</span>(<span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span> *&gt; (&amp;b), <span class="built_in">sizeof</span>(b));</span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="向字符串输出"><a href="#向字符串输出" class="headerlink" title="向字符串输出"></a>向字符串输出</h4><ul>
<li>用于构造字符串</li>
<li>功能<ul>
<li>支持ofstream类的除了open,close外的所有操作</li>
<li>str函数可以返回当前已构造的字符串</li>
</ul>
</li>
<li>典型应用<ul>
<li>将数值转换为字符串</li>
</ul>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ostringstream os;</span><br><span class="line">os &lt;&lt; <span class="number">123</span>;</span><br><span class="line">string s = os.<span class="built_in">str</span>();</span><br></pre></td></tr></table></figure>

<h3 id="输入流"><a href="#输入流" class="headerlink" title="输入流"></a>输入流</h3><p>重要的输入流类</p>
<ul>
<li>istream 最适用于顺序文本输入，cin是他的实例</li>
<li>ifstream 支持磁盘文件输入</li>
<li>istringstream 字符串输入</li>
</ul>
<p>构造输入流对象</p>
<ul>
<li>如果在构造函数中指定文件，在构造对象时自动打开<br>  ifstream ifs(‘data.bat’);</li>
<li>调用默认构造函数后使用open打开<br>  ifstream ifs;<br>  ifs.open(‘data.bat’);</li>
<li>打开文件时可以指定模式</li>
</ul>
<p>输入流相关函数</p>
<ul>
<li>open 把输入流和文件关联</li>
<li>get 函数的功能与提取运算符(&gt;&gt;)很像，主要的不同点是get函数在读入数据时包括空白字符</li>
<li>getLine 的功能是读取多个字符，并且可以指定终止字符，读取完成后，从读取内容中删除终止字符</li>
<li>read 函数从一个文件读字节到内存中的指定区域，由长度确定要读的字节数。当遇到文件结束或在文本模式文件中遇到文件结束标记字符时结束读取。可以读取二进制。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> b[<span class="number">3</span>] =&#123;<span class="number">912</span>,<span class="number">2456</span>,<span class="number">37890</span>&#125;;</span><br><span class="line">    <span class="function">ofstream <span class="title">file</span><span class="params">(<span class="string">&quot;date&quot;</span>, ios_base::binary)</span></span>;</span><br><span class="line">    file.<span class="built_in">write</span>(<span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span> *&gt; (b), <span class="built_in">sizeof</span>(b));</span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">    <span class="type">int</span> i2;</span><br><span class="line">    <span class="function">ifstream <span class="title">mfile</span><span class="params">(<span class="string">&quot;date&quot;</span>, ios_base::binary)</span></span>;</span><br><span class="line">    mfile.<span class="built_in">seekg</span>(<span class="number">2</span> * <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    mfile.<span class="built_in">read</span>(<span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span> *&gt;(&amp;i2), <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    cout &lt;&lt; i2 &lt;&lt;endl;</span><br><span class="line">    mfile.<span class="built_in">close</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="字符串输入"><a href="#字符串输入" class="headerlink" title="字符串输入"></a>字符串输入</h4><p>用于从字符串读取数据</p>
<h4 id="输入输出流"><a href="#输入输出流" class="headerlink" title="输入输出流"></a>输入输出流</h4><p>输入输出流都是从iostream派生的</p>
<ul>
<li>fstream</li>
<li>stringstream</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://thepatterraining.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%B8%89%E8%8A%82.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpeg">
      <meta itemprop="name" content="Thepatter">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dream">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%B8%89%E8%8A%82.html" class="post-title-link" itemprop="url">数据库系统原理第十三节</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-28 10:12:47" itemprop="dateCreated datePublished" datetime="2021-08-28T10:12:47+08:00">2021-08-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-26 10:07:53" itemprop="dateModified" datetime="2025-01-26T10:07:53+08:00">2025-01-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">数据库系统原理</span></a>
                </span>
            </span>

          
            <span id="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%B8%89%E8%8A%82.html" class="post-meta-item leancloud_visitors" data-flag-title="数据库系统原理第十三节" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%B8%89%E8%8A%82.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%B8%89%E8%8A%82.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="数据库系统原理第十三节"><a href="#数据库系统原理第十三节" class="headerlink" title="数据库系统原理第十三节"></a>数据库系统原理第十三节</h1><h2 id="数据库安全和保护"><a href="#数据库安全和保护" class="headerlink" title="数据库安全和保护"></a>数据库安全和保护</h2><h3 id="安全性与访问控制"><a href="#安全性与访问控制" class="headerlink" title="安全性与访问控制"></a>安全性与访问控制</h3><p>数据库安全：指保护数据库以防止不合法的使用而造成数据泄露，更改或破坏，所以安全性对于任何一个DBMS来说都是至关重要的</p>
<ul>
<li>身份验证</li>
<li>数据库用户权限确认</li>
</ul>
<p>查看用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> mysql.user</span><br></pre></td></tr></table></figure>

<p>创建用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="keyword">user</span>[identified <span class="keyword">by</span> [password]<span class="string">&#x27;password&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>create user ‘test‘@’%’ identified by ‘123’</p>
<p>create user ‘tset‘@’%’ identified by password ‘jdkfjalkdjskflajsdfa’</p>
<p>删除用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">user</span> <span class="keyword">user</span></span><br></pre></td></tr></table></figure>

<p>drop user ‘test‘@’%’</p>
<p>修改用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename <span class="keyword">user</span> old_user <span class="keyword">to</span> new_user</span><br></pre></td></tr></table></figure>

<p>修改密码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> password <span class="keyword">for</span> <span class="string">&#x27;test&#x27;</span>@<span class="string">&#x27;%&#x27;</span> <span class="operator">=</span> PASSWORD(<span class="string">&#x27;pass&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="账号权限管理"><a href="#账号权限管理" class="headerlink" title="账号权限管理"></a>账号权限管理</h4><p>使用grant 为用户授权</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span></span><br><span class="line">    priv_type[<span class="keyword">column</span>]</span><br><span class="line">    <span class="keyword">on</span> [object_type] priv_level</span><br><span class="line">    <span class="keyword">to</span> <span class="keyword">user</span></span><br><span class="line">    [<span class="keyword">with</span> <span class="keyword">grant</span> option]</span><br></pre></td></tr></table></figure>

<p>grant select (id, name)<br>on test.test_table<br>to test@’localhost’</p>
<h4 id="收回用户权限"><a href="#收回用户权限" class="headerlink" title="收回用户权限"></a>收回用户权限</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">revoke</span> </span><br><span class="line">    priv_type</span><br><span class="line">    <span class="keyword">on</span> [object_type]</span><br><span class="line">    <span class="keyword">from</span> <span class="keyword">user</span></span><br></pre></td></tr></table></figure>

<p>revoke select on test.test_table from ‘test‘@’localhost’</p>
<h3 id="事务与并发控制"><a href="#事务与并发控制" class="headerlink" title="事务与并发控制"></a>事务与并发控制</h3><p>所谓事务是用户定义的一个<code>数据操作序列</code>，这些操作可作为一个完整的工作单元，要么全部执行，要么全部不执行，是一个不可分割的工作单位。事务中的操作一般是对数据的更新操作，包括<code>增删改</code></p>
<p>以 <code>begin transaction</code>开始<br>commit 或 rollback结束</p>
<p>事务的特征 </p>
<ul>
<li>A 原子性</li>
<li>C 一致性</li>
<li>I 隔离性</li>
<li>D 持续性</li>
</ul>
<h6 id="并发操作问题"><a href="#并发操作问题" class="headerlink" title="并发操作问题"></a>并发操作问题</h6><ul>
<li>丢失更新</li>
<li>不可重复读</li>
<li>读‘脏’数据</li>
</ul>
<h6 id="封锁"><a href="#封锁" class="headerlink" title="封锁"></a>封锁</h6><p>封锁 是最常用的并发控制技术</p>
<p>基本思想：需要时，事务通过向系统请求对它所希望的数据对象加锁，以确保它不被非预期改变</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://thepatterraining.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E5%9B%9B%E8%8A%82.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpeg">
      <meta itemprop="name" content="Thepatter">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dream">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E5%9B%9B%E8%8A%82.html" class="post-title-link" itemprop="url">数据库系统原理第十四节</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-28 10:12:47" itemprop="dateCreated datePublished" datetime="2021-08-28T10:12:47+08:00">2021-08-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-26 10:07:53" itemprop="dateModified" datetime="2025-01-26T10:07:53+08:00">2025-01-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">数据库系统原理</span></a>
                </span>
            </span>

          
            <span id="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E5%9B%9B%E8%8A%82.html" class="post-meta-item leancloud_visitors" data-flag-title="数据库系统原理第十四节" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E5%9B%9B%E8%8A%82.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E5%9B%9B%E8%8A%82.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="数据库系统原理第十四节"><a href="#数据库系统原理第十四节" class="headerlink" title="数据库系统原理第十四节"></a>数据库系统原理第十四节</h1><h2 id="数据库安全和保护"><a href="#数据库安全和保护" class="headerlink" title="数据库安全和保护"></a>数据库安全和保护</h2><h3 id="事务与并发控制"><a href="#事务与并发控制" class="headerlink" title="事务与并发控制"></a>事务与并发控制</h3><p>所谓事务是用户定义的一个<code>数据操作序列</code>，这些操作可作为一个完整的工作单元，要么全部执行，要么全部不执行，是一个不可分割的工作单位。事务中的操作一般是对数据的更新操作，包括<code>增删改</code></p>
<p>以 <code>begin transaction</code>开始<br>commit 或 rollback结束</p>
<p>事务的特征 </p>
<ul>
<li>A 原子性</li>
<li>C 一致性</li>
<li>I 隔离性</li>
<li>D 持续性</li>
</ul>
<h6 id="并发操作问题"><a href="#并发操作问题" class="headerlink" title="并发操作问题"></a>并发操作问题</h6><ul>
<li>丢失更新</li>
<li>不可重复读</li>
<li>读‘脏’数据</li>
</ul>
<h6 id="封锁"><a href="#封锁" class="headerlink" title="封锁"></a>封锁</h6><p>封锁 是最常用的并发控制技术</p>
<p>基本思想：需要时，事务通过向系统请求对它所希望的数据对象加锁，以确保它不被非预期改变</p>
<p>一个<code>锁</code>实质上就是允许或阻止一个事务对一个数据对象的存取特权</p>
<p>基本的封锁类型</p>
<ul>
<li>排它锁，用于写操作</li>
<li>共享锁，用于读操作</li>
</ul>
<p>封锁的粒度<br>粒度越细，并发性就越大，但软件复杂性和系统开销也就越大</p>
<p><code>封锁的级别</code>又称为一致性级别或隔离度</p>
<ul>
<li>0级封锁：不重写其他非0级封锁事务的未提交的更新数据</li>
<li>1级封锁：不允许重写未提交的更新数据。防止了丢失更新的发生</li>
<li>2级封锁：既不重写也不读未提交的更新数据（防止了读脏数据）</li>
<li>3级封锁：不读未提交的更新数据，不写任何（包括读操作）未提交数据</li>
</ul>
<p>活锁：先来先服务<br>死锁：预防</p>
<ul>
<li>一次性锁请求</li>
<li>锁请求排序</li>
<li>序列化处理</li>
<li>资源剥夺</li>
</ul>
<p>可串行性<br>一组事务的一个调度就是它们的基本操作的一种排序</p>
<p>在数据库系统中，可串行性就是并发执行的<code>正确性准则</code></p>
<p>两段封锁法</p>
<ul>
<li>发展或加锁阶段</li>
<li>收缩或释放锁阶段</li>
</ul>
<h3 id="备份与恢复"><a href="#备份与恢复" class="headerlink" title="备份与恢复"></a>备份与恢复</h3><p>备份</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">into</span> outfile <span class="string">&#x27;file_name&#x27;</span> export_options  </span><br><span class="line">              dumpfile <span class="string">&#x27;file_name&#x27;</span></span><br><span class="line">    fields terminated <span class="keyword">by</span> <span class="string">&#x27;,&#x27;</span>  逗号分隔</span><br><span class="line">    optionally enclosed <span class="keyword">by</span> &quot;&quot;  字符串用双引号</span><br><span class="line">    lines terminated <span class="keyword">by</span> <span class="string">&#x27;?&#x27;</span>  问号分隔每行数据</span><br></pre></td></tr></table></figure>

<p>dumpfile 导出的备份文件里面所有的数据都彼此紧挨着</p>
<p>导入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">load data infile <span class="string">&#x27;file_name&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> table_name</span><br><span class="line">fields terminated <span class="keyword">by</span> <span class="string">&#x27;,&#x27;</span>  逗号分隔</span><br><span class="line">    optionally enclosed <span class="keyword">by</span> &quot;&quot;  字符串用双引号</span><br><span class="line">    lines terminated <span class="keyword">by</span> <span class="string">&#x27;?&#x27;</span>  问号分隔每行数据</span><br></pre></td></tr></table></figure>

<p>数据库生命周期</p>
<ul>
<li>需求分析</li>
<li>系统功能与数据库的设计</li>
<li>系统功能与数据库的实现</li>
<li>测试与维护</li>
</ul>
<h4 id="php-mysql应用"><a href="#php-mysql应用" class="headerlink" title="php mysql应用"></a>php mysql应用</h4><p>连接数据库非持久连接</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$con</span> = <span class="title function_ invoke__">mysql_connect</span>(<span class="string">&quot;localhost:3306&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"></span><br><span class="line">持久连接 mysql_pconnect</span><br><span class="line"></span><br><span class="line">选择数据库 <span class="title function_ invoke__">mysql_select_db</span>(<span class="string">&quot;test&quot;</span>, <span class="variable">$con</span>)</span><br><span class="line"></span><br><span class="line">执行 sql <span class="title function_ invoke__">mysql_query</span>(<span class="string">&quot;set names &#x27;gbk&#x27;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$res</span> = <span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>, <span class="variable">$con</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$array</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$res</span>, MYSQL_NUM);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">mysql_close</span>(<span class="variable">$con</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;关闭失败&quot;</span>);</span><br></pre></td></tr></table></figure>





      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://thepatterraining.github.io/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpeg">
      <meta itemprop="name" content="Thepatter">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dream">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0.html" class="post-title-link" itemprop="url">学堂在线C++程序设计第十二章学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-23 10:12:47" itemprop="dateCreated datePublished" datetime="2021-08-23T10:12:47+08:00">2021-08-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-26 10:07:53" itemprop="dateModified" datetime="2025-01-26T10:07:53+08:00">2025-01-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
            </span>

          
            <span id="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0.html" class="post-meta-item leancloud_visitors" data-flag-title="学堂在线C++程序设计第十二章学习笔记" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="学堂在线C-程序设计第十二章学习笔记"><a href="#学堂在线C-程序设计第十二章学习笔记" class="headerlink" title="学堂在线C++程序设计第十二章学习笔记"></a>学堂在线C++程序设计第十二章学习笔记</h1><h2 id="泛型程序设计和标准模板库"><a href="#泛型程序设计和标准模板库" class="headerlink" title="泛型程序设计和标准模板库"></a>泛型程序设计和标准模板库</h2><h3 id="泛型及STL"><a href="#泛型及STL" class="headerlink" title="泛型及STL"></a>泛型及STL</h3><p>泛型程序设计</p>
<ul>
<li>编写不依赖于具体数据类型的程序</li>
<li>将算法从特定的数据结构中抽象出来成为通用的</li>
<li>C++的模板为泛型程序设计奠定了关键的基础</li>
</ul>
<p>术语：概念</p>
<ul>
<li>可以比较大小的数据类型记作<code>Comparable</code></li>
<li>具有公有的复制函数并可以用 &#x3D; 赋值的记作<code>Assignable</code></li>
<li>将 可以比较大小 并且 具有公有复制函数可以用 &#x3D; 赋值的记作<code>Sortable</code></li>
</ul>
<p>对于两个不同的概念A，B,如果A所需求的所有功能也是B所需求的，那么B是A的子概念，比如，Sortable是 Comparable 的子概念，也是 Assignable的子概念</p>
<p>术语：模型</p>
<ul>
<li>符合一个概念的数据类型称为该概念的模型</li>
<li>比如 int 型是 Comparable的模型</li>
<li>静态数组不是 Assignable的模型</li>
</ul>
<h4 id="STL"><a href="#STL" class="headerlink" title="STL"></a>STL</h4><ul>
<li>标准模板库STL定义了一套概念体系，为泛型程序设计提供了逻辑基础</li>
<li>STL中的各个类模板，函数模板的参数都是用这个体系中的概念来规定的</li>
<li>使用STL模板时，类型参数既可以是C++标准库中已有的类型，也可以是自定义的类型–只要这些类型是所要求的概念的模型</li>
</ul>
<p>STL基本组件</p>
<ul>
<li>容器（container）：容纳，包含一组元素的对象<ul>
<li>顺序容器：<br>  array,vector,双端队列，单链表，列表</li>
<li>有序容器：<br>  集合，多重集合，map,多重映射</li>
<li>无序关联容器<br>  无序集合，无序多重集合，无序映射，无序多重映射</li>
</ul>
</li>
<li>迭代器（iterator）<ul>
<li>提供了顺序访问容器中每个元素的方法</li>
<li>可以使用 ++ 运算符来获得指向下一个元素的迭代器</li>
<li>可以使用 * 运算符访问迭代器指向的元素，如果元素类型是类或结构体，还可以使用 -&gt; 运算符直接访问成员</li>
<li>有些迭代器还支持通过 – 运算符获得指向上一个元素的迭代器</li>
<li>迭代器是泛化的指针：指针也具有同样的特性，因此指针本身就是一种迭代器</li>
<li>使用独立于STL容器的迭代器，需要包含头文件<iterator></li>
</ul>
</li>
<li>函数对象（function object）</li>
<li>算法（algorithms）</li>
</ul>
<p><code>迭代器</code>是<code>算法</code>和<code>容器</code>的桥梁</p>
<ul>
<li>将迭代器作为算法的参数，通过迭代器来访问容器而不是把容器直接作为算法参数</li>
<li>将<code>函数对象</code>作为算法参数而不是将函数所执行的运算作为算法的一部分。</li>
<li>使用STL中提供的或自定义的迭代器和函数对象，配合STL的算法，可以组合出各种各样的功能</li>
</ul>
<p>容器适配器</p>
<ul>
<li>栈</li>
<li>队列</li>
</ul>
<h3 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h3><p>迭代器是算法和容器的桥梁</p>
<ul>
<li>迭代器用作访问容器中的元素</li>
<li>算法不直接操作容器中的数据，而是通过迭代器间接操作</li>
</ul>
<p>算法和容器独立</p>
<ul>
<li>增加新的算法，无需影响容器的实现</li>
<li>增加新的容器，原有的算法也可以适用</li>
</ul>
<p>输入流迭代器</p>
<ul>
<li>istream_iterator<T></li>
<li>以输入流 如 cin 为参数构造</li>
<li>可用 *(p++) 获得下一个输入的元素</li>
</ul>
<p>输出流迭代器</p>
<ul>
<li>ostream_iterator<T></li>
<li>构造时需要提供输出流 如 cout</li>
<li>可用 (*p++) &#x3D; x 将 x 输出到输出流</li>
</ul>
<p>二者都属于适配器</p>
<ul>
<li>适配器是用来为已有对象提供新的接口的对象</li>
<li>输入流适配器和输出流适配器为流对象提供了迭代器的接口</li>
</ul>
<h3 id="容器的基本功能和分类"><a href="#容器的基本功能和分类" class="headerlink" title="容器的基本功能和分类"></a>容器的基本功能和分类</h3><ul>
<li>容器类是容纳，包含一组元素或元素集合的对象</li>
<li>基于容器中元素的组织方式分类：顺序容器，关联容器</li>
<li>按照与容器所关联的迭代器类型分类：可逆容器，随机访问容器</li>
</ul>
<h3 id="顺序容器"><a href="#顺序容器" class="headerlink" title="顺序容器"></a>顺序容器</h3><h5 id="顺序容器的基本功能"><a href="#顺序容器的基本功能" class="headerlink" title="顺序容器的基本功能"></a>顺序容器的基本功能</h5><ul>
<li>STL中的顺序容器<ul>
<li>向量</li>
<li>双端队列(deque)</li>
<li>列表(list)</li>
<li>单向链表(forward_list)</li>
<li>数组(array)</li>
</ul>
</li>
<li>元素线性排列，可以随时在指定位置插入元素和删除元素</li>
<li>必须符合 Assignable 这一概念（具有共有的复制构造函数并可以用 ‘&#x3D;’ 赋值）</li>
<li>array 对象的大小固定，forward_list有特殊的添加和删除操作</li>
</ul>
<p>顺序容器的接口（不包含单向链表和数组）</p>
<ul>
<li>构造函数</li>
<li>赋值函数：assign</li>
<li>插入函数: insert, push_front(只对list和deque)，push_back, emplace, emplace_front</li>
<li>删除函数：erase, clear, pop_front, pop_back, emplace_back</li>
<li>首尾元素的直接访问：front, back</li>
<li>改变大小：resize</li>
</ul>
<h4 id="顺序容器的特征"><a href="#顺序容器的特征" class="headerlink" title="顺序容器的特征"></a>顺序容器的特征</h4><p>向量</p>
<ul>
<li>特点<ul>
<li>一个可以扩展的动态数组</li>
<li>随机访问，在尾部插入或删除元素块</li>
<li>在中间或头部插入或删除元素慢</li>
</ul>
</li>
<li>容量<ul>
<li>容量：实际分配空间的大小</li>
<li>s.capacity: 返回当前容量</li>
<li>s.reserve(n): 容量小于n，则对s进行扩展，使其容量至少为n</li>
</ul>
</li>
</ul>
<p>双端队列</p>
<ul>
<li>特点<ul>
<li>在两端插入或删除元素快</li>
<li>在中间插入或删除元素慢</li>
<li>随机访问较快，但比向量慢</li>
</ul>
</li>
</ul>
<p>列表</p>
<ul>
<li>特点<ul>
<li>在任意位置插入和删除元素都很快</li>
<li>不支持随机访问</li>
</ul>
</li>
<li>接合操作（splice）<ul>
<li>s.splice(p, s2, q1, q2): 将s2中[q1,q2)移动到s1中p所指向元素之前</li>
</ul>
</li>
</ul>
<h4 id="顺序容器的插入迭代器与适配器"><a href="#顺序容器的插入迭代器与适配器" class="headerlink" title="顺序容器的插入迭代器与适配器"></a>顺序容器的插入迭代器与适配器</h4><p>顺序容器的插入迭代器</p>
<ul>
<li>用于向容器头部，尾部或中间指定位置插入元素的迭代器</li>
<li>包括前插迭代器（front_inserter），后插迭代器（back_inserter）和任意位置插入迭代器（inserter）</li>
<li>例子：<br>  list<int> s;<br>  back_iserter iter(s);<br>  *(iter++) &#x3D; 5; &#x2F;&#x2F;通过iter把5插入s末尾</li>
</ul>
<p>顺序容器的适配器</p>
<ul>
<li>以顺序容器为基础构建一些常用数据结构，是对顺序容器的封装<ul>
<li>栈</li>
<li>队列</li>
<li>优先级队列：最 <code>大</code> 的先弹出</li>
</ul>
</li>
</ul>
<p>栈和队列模板</p>
<ul>
<li>栈模板<br>  template &lt;class T, class Sequence &#x3D; deque<T>&gt; class stack;</li>
<li>队列模板<br>  template &lt;class T,class FrontInsertionSequence &#x3D; deque<T>&gt; class queue;</li>
<li>栈可以用任何一种顺序容器作为基础容器，而队列只允许用前插顺序容器（双端队列或列表）</li>
</ul>
<p>栈和队列共同支持的操作</p>
<ul>
<li>比较</li>
<li>返回元素个数</li>
<li>empty</li>
<li>push</li>
<li>pop</li>
<li>不支持迭代器，因为不允许对任意元素访问</li>
</ul>
<p>栈和队列不同的操作</p>
<ul>
<li>栈的操作<br>  s.top 返回栈顶元素的引用</li>
<li>队列操作<br>  s.front 获得队头元素的引用<br>  s.back 获得队尾元素的引用</li>
</ul>
<p>优先级队列</p>
<ul>
<li>优先级队列也像栈和队列一样支持元素的压入和弹出，但元素弹出顺序和元素大小有关，每次弹出最大的</li>
<li>template &lt;class T, class Sequence &#x3D; Vector<T>&gt; class priority_queue</li>
<li>优先级队列的基础容器必须是支持随机访问的顺序容器</li>
<li>支持栈和队列的size,empty, push, pop几个函数</li>
<li>优先级队列并不支持比较操作</li>
<li>与栈类似，优先级队列提供一个 top 函数，可以获得下一个即将被弹出元素的引用</li>
</ul>
<h3 id="关联容器"><a href="#关联容器" class="headerlink" title="关联容器"></a>关联容器</h3><h4 id="分类和基本功能"><a href="#分类和基本功能" class="headerlink" title="分类和基本功能"></a>分类和基本功能</h4><p>关联容器的特点</p>
<ul>
<li>每个关联容器都有一个key</li>
<li>可以根据key高效查找元素</li>
</ul>
<p>接口</p>
<ul>
<li>插入insert</li>
<li>删除 erase</li>
<li>查找 find</li>
<li>定界 lower_bound,upper_bound,equal_bound</li>
<li>计数 count</li>
</ul>
<h4 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h4><p>集合用来存储一组无重复的数据。用于集合的元素本身是有序的，可以高效查找元素，也可以方便的得到指定大小范围的元素在容器中所处的区间</p>
<h4 id="映射"><a href="#映射" class="headerlink" title="映射"></a>映射</h4><p>映射和集合的主要区别</p>
<ul>
<li><p>集合的元素类型是key本身</p>
</li>
<li><p>映射的元素类型是key,value二元组</p>
</li>
<li><p>在集合中按照key查找一个元素时，一般只是确定这个元素是否存在。</p>
</li>
<li><p>映射中按照key查找时，除了能确定是否存在外，还可以得到相应的附加数据</p>
</li>
</ul>
<h4 id="多重集合和多重映射"><a href="#多重集合和多重映射" class="headerlink" title="多重集合和多重映射"></a>多重集合和多重映射</h4><ul>
<li>多重集合允许有重复元素的集合，多重映射允许一个key对应多个value</li>
<li>多重集合与集合，多重映射与映射的用法差不多</li>
</ul>
<h3 id="函数对象"><a href="#函数对象" class="headerlink" title="函数对象"></a>函数对象</h3><p>函数对象</p>
<ul>
<li>一个行为类似函数的对象</li>
<li>可以没有参数，也可以带有若干参数</li>
<li>其功能是获取值，或者改变操作状态</li>
<li>普通函数就是函数对象</li>
<li>重载了 “()” 运算符的类的实例是函数对象</li>
</ul>
<h4 id="函数适配器"><a href="#函数适配器" class="headerlink" title="函数适配器"></a>函数适配器</h4><ul>
<li>绑定适配器<ul>
<li>bind1st, bind2nd: 将n元函数对象的指定参数绑定为一个常数，得到n-1元函数对象</li>
</ul>
</li>
<li>组合适配器<ul>
<li>not1,not2: 将指定谓词的结果取反</li>
</ul>
</li>
<li>函数指针适配器<ul>
<li>ptr_fun: 将一般函数指针转换为函数对象，使之能够作为其他函数适配器的输入</li>
<li>在进行参数绑定或其他转换的时候，通常需要函数对象的类型信息</li>
</ul>
</li>
<li>成员函数适配器:ptr_fun,ptr_fun_ref<ul>
<li>对成员函数指针使用，把n元成员函数适配为n + 1元函数对象，该函数对象的第一个参数为调用该成员函数时的目的对象</li>
<li>也就是 object-&gt;method() 变成 method(object)</li>
<li>将 object-&gt;method(arg1) 变成 method(object, arg1)</li>
</ul>
</li>
</ul>
<h4 id="STL算法"><a href="#STL算法" class="headerlink" title="STL算法"></a>STL算法</h4><p>本身是一种函数模板</p>
<ul>
<li>通过迭代器获得输入数据</li>
<li>通过函数对象对数据进行处理</li>
<li>通过迭代器将结果输出</li>
</ul>
<p>STL算法是通用的，独立于具体的数据类型，容器类型</p>
<p>分类</p>
<ul>
<li>不可变序列算法<ul>
<li>不直接修改所操作的容器内容的算法</li>
<li>用于查找指定元素，比较是否相等，对元素进行计数等</li>
</ul>
</li>
<li>可变序列算法<ul>
<li>可修改所操作的容器对象的算法</li>
<li>包括复制，删除，替换，洗牌及生成一个序列的算法</li>
</ul>
</li>
<li>排序和搜索算法<ul>
<li>对序列排序</li>
<li>搜索</li>
<li>堆算法</li>
</ul>
</li>
<li>数值算法<ul>
<li>求和，求差，积等</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://thepatterraining.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%B8%80%E8%8A%82.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpeg">
      <meta itemprop="name" content="Thepatter">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dream">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%B8%80%E8%8A%82.html" class="post-title-link" itemprop="url">数据库系统原理第十一节</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-21 10:12:47" itemprop="dateCreated datePublished" datetime="2021-08-21T10:12:47+08:00">2021-08-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-26 10:07:53" itemprop="dateModified" datetime="2025-01-26T10:07:53+08:00">2025-01-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">数据库系统原理</span></a>
                </span>
            </span>

          
            <span id="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%B8%80%E8%8A%82.html" class="post-meta-item leancloud_visitors" data-flag-title="数据库系统原理第十一节" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%B8%80%E8%8A%82.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%B8%80%E8%8A%82.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="数据库系统原理第十一节"><a href="#数据库系统原理第十一节" class="headerlink" title="数据库系统原理第十一节"></a>数据库系统原理第十一节</h1><h2 id="数据库编程"><a href="#数据库编程" class="headerlink" title="数据库编程"></a>数据库编程</h2><h3 id="存储过程体"><a href="#存储过程体" class="headerlink" title="存储过程体"></a>存储过程体</h3><p>使用 declare 声明局部变量</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> cid <span class="type">int</span>(<span class="number">10</span>) <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>只能值begin end中声明</li>
<li>必须在存储过程开头声明</li>
<li>不同于用户变量</li>
<li>作用范围仅限于声明他的begin end语句块</li>
</ul>
<p>局部变量和用户变量的区别</p>
<ul>
<li>局部变量前面没有@符号，并且他只能被声明的begin end语句块中使用</li>
<li>用户变量在声明时前面有@符号，同时已声明的用户变量存在于整个会话之中</li>
</ul>
<p>使用 set 为局部变量赋值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> cid <span class="operator">=</span> <span class="number">910</span>;</span><br></pre></td></tr></table></figure>

<p>select id into cid table</p>
<p>流程控制语句</p>
<p>条件判断<br>if 条件 then<br>    表达式1<br>else<br>    表达式2<br>end if</p>
<p>循环语句</p>
<ul>
<li>while</li>
<li>repeat</li>
<li>loop</li>
</ul>
<p>iterate语句<br>用于表示退出当前循环</p>
<p>declare cursor创建游标</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> cursor_name <span class="keyword">cursor</span> <span class="keyword">for</span> select_statement</span><br></pre></td></tr></table></figure>

<p>open 打开游标</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> cursor_name</span><br></pre></td></tr></table></figure>

<p>使用 fetch into 读取游标数据<br>读取已打开的游标</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fetch</span> cursor_name <span class="keyword">into</span> var_name</span><br></pre></td></tr></table></figure>

<p>使用 close 关闭游标</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">close</span> cursor_name</span><br></pre></td></tr></table></figure>

<h3 id="存储函数"><a href="#存储函数" class="headerlink" title="存储函数"></a>存储函数</h3><p>由SQL语句和过程式语句组成</p>
<p>使用 create function 创建</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> sp_name(参数)</span><br><span class="line">    <span class="keyword">returns</span> type</span><br><span class="line">    routine_body <span class="operator">/</span><span class="operator">/</span>主体</span><br></pre></td></tr></table></figure>

<p>给定id号返回性别</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">use test;</span><br><span class="line">delimiter $$</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> fn_search(cid <span class="type">int</span>)</span><br><span class="line">    <span class="keyword">returns</span> <span class="type">char</span>(<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">deterministic</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">declare</span> sex <span class="type">char</span>(<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">select</span> cust_sex <span class="keyword">into</span> sex <span class="keyword">from</span> customers <span class="keyword">where</span> id <span class="operator">=</span> cid;</span><br><span class="line">    if sex <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">return</span>(<span class="keyword">select</span> <span class="string">&#x27;没有该客户&#x27;</span>);</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        if sex <span class="operator">=</span> <span class="string">&#x27;F&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="keyword">return</span>(<span class="keyword">select</span> <span class="string">&#x27;女&#x27;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span>(<span class="keyword">select</span> <span class="string">&#x27;男&#x27;</span>);</span><br><span class="line">        <span class="keyword">end</span> if;</span><br><span class="line">    <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span> $$</span><br></pre></td></tr></table></figure>

<p>存储函数和存储过程的区别<br>存储函数不能有输出参数，存储过程有<br>存储函数必须包含一条return语句，存储过程不包含return<br>存储函数可以直接调用，不需要call，存储过程必须call</p>
<p>使用 select 调用存储函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> fn_search(<span class="number">1</span>)$$</span><br></pre></td></tr></table></figure>

<p>删除存储函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">function</span> fun_name</span><br></pre></td></tr></table></figure>

<h2 id="数据库安全和保护"><a href="#数据库安全和保护" class="headerlink" title="数据库安全和保护"></a>数据库安全和保护</h2><h3 id="数据库完整性"><a href="#数据库完整性" class="headerlink" title="数据库完整性"></a>数据库完整性</h3><p>正确性和相容性</p>
<ul>
<li>列级约束，包含列的类型，取值范围，精度</li>
<li>元组约束，指元组中各个字段之间的约束</li>
<li>表级约束，指若干元组，关系之间的联系的约束</li>
</ul>
<p>实体完整性：主键约束和候选键约束</p>
<p>主键</p>
<ul>
<li>一个表只能有一个主键</li>
<li>主键唯一，不能为NULL</li>
<li>复合主键不能包含不必要的多余列</li>
<li>一个列名在复合主键的列表中只能出现一次</li>
</ul>
<p>主键约束：primary key, create table 或 alter table,一个表只能创建一个主键<br>候选键约束：unique, create table 或 alter table，可以定义若干个候选键</p>
<h5 id="参照完整性"><a href="#参照完整性" class="headerlink" title="参照完整性"></a>参照完整性</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">references</span> table_name(index_col_name)</span><br><span class="line">[<span class="keyword">on</span> <span class="keyword">delete</span> reference_option]</span><br><span class="line">[<span class="keyword">on</span> <span class="keyword">update</span> reference_option]</span><br><span class="line"></span><br><span class="line">restrict<span class="operator">|</span>cascade<span class="operator">|</span><span class="keyword">set</span> <span class="keyword">null</span><span class="operator">|</span><span class="keyword">no</span> action</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://thepatterraining.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%BA%8C%E8%8A%82.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpeg">
      <meta itemprop="name" content="Thepatter">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dream">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%BA%8C%E8%8A%82.html" class="post-title-link" itemprop="url">数据库系统原理第十二节</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-21 10:12:47" itemprop="dateCreated datePublished" datetime="2021-08-21T10:12:47+08:00">2021-08-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-26 10:07:53" itemprop="dateModified" datetime="2025-01-26T10:07:53+08:00">2025-01-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">数据库系统原理</span></a>
                </span>
            </span>

          
            <span id="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%BA%8C%E8%8A%82.html" class="post-meta-item leancloud_visitors" data-flag-title="数据库系统原理第十二节" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%BA%8C%E8%8A%82.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86%E7%AC%AC%E5%8D%81%E4%BA%8C%E8%8A%82.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="数据库系统原理第十二节"><a href="#数据库系统原理第十二节" class="headerlink" title="数据库系统原理第十二节"></a>数据库系统原理第十二节</h1><h2 id="数据库安全和保护"><a href="#数据库安全和保护" class="headerlink" title="数据库安全和保护"></a>数据库安全和保护</h2><h3 id="数据库完整性"><a href="#数据库完整性" class="headerlink" title="数据库完整性"></a>数据库完整性</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> orders</span><br><span class="line">order_id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span> auto_increment,</span><br><span class="line">cust_id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="number">0</span>,</span><br><span class="line"><span class="keyword">primary</span> key(order_id),</span><br><span class="line"><span class="keyword">foreign</span> key(cust_id)</span><br><span class="line">refrences table_name(id)</span><br><span class="line"><span class="keyword">on</span> <span class="keyword">delete</span> restrict</span><br><span class="line"><span class="keyword">on</span> <span class="keyword">update</span> restrict</span><br></pre></td></tr></table></figure>

<h4 id="用户定义完整性约束"><a href="#用户定义完整性约束" class="headerlink" title="用户定义完整性约束"></a>用户定义完整性约束</h4><p>非空 约束 not null<br>check 约束 check(sex &#x3D; ‘f’)</p>
<p>命名完整性约束 constraint[指定的约束名字]<br>只能给基于表的完整性约束指定名字<br>基于列的不行</p>
<p>更新完整性约束<br>使用<code>alter table</code>更新与列或表有关的各种约束</p>
<ul>
<li>完整性约束不能直接修改（先删除，再增加）</li>
<li>alter table 独立删除完整性约束，而不会删除表，drop table删除表也会删除完整性约束</li>
</ul>
<h3 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h3><p>用户定义在关系表上的一类由事件驱动的数据对象，也是一种保证数据完整性的方法</p>
<h4 id="创建触发器"><a href="#创建触发器" class="headerlink" title="创建触发器"></a>创建触发器</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> 名称 时间 事件</span><br><span class="line"><span class="keyword">on</span> 表 <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span> 主体</span><br></pre></td></tr></table></figure>

<p>插入数据时改变变量值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> t_name after <span class="keyword">insert</span></span><br><span class="line"><span class="keyword">on</span> table_name <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span> <span class="keyword">set</span> <span class="variable">@str</span> <span class="operator">=</span> <span class="string">&#x27;one customer added&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="使用触发器"><a href="#使用触发器" class="headerlink" title="使用触发器"></a>使用触发器</h4><p>insert 触发器</p>
<ul>
<li>可引用一个名为 <code>new</code> 的虚拟表，来访问被插入的行</li>
<li>before insert ， new 中的值<code>可以被更新</code><br>delete 触发器</li>
<li>可引用 <code>old</code>的虚拟表，来访问被删除的行</li>
<li>old 只读<br>update 触发器</li>
<li>可引用<code>old</code>的虚拟表来访问update执行前的值，也可以引用<code>new</code>访问更新后的值</li>
</ul>
<h3 id="安全性与访问控制"><a href="#安全性与访问控制" class="headerlink" title="安全性与访问控制"></a>安全性与访问控制</h3><p>数据库安全：指保护数据库以防止不合法的使用而造成数据泄露，更改或破坏，所以安全性对于任何一个DBMS来说都是至关重要的</p>
<ul>
<li>身份验证</li>
<li>数据库用户权限确认</li>
</ul>
<p>查看用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> mysql.user</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://thepatterraining.github.io/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpeg">
      <meta itemprop="name" content="Thepatter">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dream">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0.html" class="post-title-link" itemprop="url">学堂在线C++程序设计第十一章学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-18 10:12:47" itemprop="dateCreated datePublished" datetime="2021-08-18T10:12:47+08:00">2021-08-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-26 10:07:53" itemprop="dateModified" datetime="2025-01-26T10:07:53+08:00">2025-01-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index"><span itemprop="name">C++</span></a>
                </span>
            </span>

          
            <span id="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0.html" class="post-meta-item leancloud_visitors" data-flag-title="学堂在线C++程序设计第十一章学习笔记" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/C++%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="学堂在线C-程序设计第十一章学习笔记"><a href="#学堂在线C-程序设计第十一章学习笔记" class="headerlink" title="学堂在线C++程序设计第十一章学习笔记"></a>学堂在线C++程序设计第十一章学习笔记</h1><h2 id="模板和群体数据"><a href="#模板和群体数据" class="headerlink" title="模板和群体数据"></a>模板和群体数据</h2><h3 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h3><h4 id="函数模板"><a href="#函数模板" class="headerlink" title="函数模板"></a>函数模板</h4><p>如果不使用函数模板，需要写多个函数，比如求绝对值</p>
<ul>
<li>整数绝对值</li>
<li>浮点数绝对值</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">abs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &lt; <span class="number">0</span> ? -x : x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">abs</span><span class="params">(<span class="type">double</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &lt; <span class="number">0</span> ? -x : x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用模板函数可以只写一个函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">T <span class="title">abs</span><span class="params">(T x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &lt; <span class="number">0</span> ? -x : x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果使用int参数调用，那么编译器会根据上面的模板生成一个int型的绝对值函数，也就是将T类型换成int类型</p>
<p>函数模板定义语法</p>
<ul>
<li>语法<br>  template &lt;模板参数表&gt;<br>  函数定义</li>
<li>模板参数表的内容<ul>
<li>类型参数 class (或 typename) 标识符</li>
<li>常量参数 类型说明符 标识符</li>
<li>模板参数 template&lt;参数表&gt; class 标识符</li>
</ul>
</li>
</ul>
<p>注意：</p>
<ul>
<li>一个函数模板并非自动可以处理所有类型的数据</li>
<li>只有能够进行函数模板中运算的类型 可以作为类型实参</li>
<li>自定义的类，需要重载模板中的运算符，才能作为类型实参</li>
</ul>
<h4 id="类模板"><a href="#类模板" class="headerlink" title="类模板"></a>类模板</h4><p>类模板的作用<br>使用类模板使用户可以为类声明一种模式，使得类中的某些数据成员，某些成员函数的参数，某些成员函数的返回值，能取任意类型</p>
<p>声明</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;模板参数表&gt;</span><br><span class="line"><span class="keyword">class</span> 类名</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果需要再类模板以外定义其成员函数，则要求采用以下的形式：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;模板参数表&gt;</span><br><span class="line">类型名 类名&lt;模板参数标识符列表&gt;::函数名(参数)</span><br></pre></td></tr></table></figure>

<p>定义一个类模板</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Store</span>&#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        T item;</span><br><span class="line">        <span class="type">bool</span> haveValue;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">Store</span>();</span><br><span class="line">        <span class="function">T &amp;<span class="title">getElem</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">putElem</span><span class="params">(<span class="type">const</span> T &amp;x)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line">T Store&lt;T&gt;::<span class="built_in">getElem</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> item;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="type">void</span> Store&lt;T&gt;::<span class="built_in">putElem</span>(<span class="type">const</span> T *x) &#123;</span><br><span class="line">    item = x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line">Store&lt;T&gt;::<span class="built_in">Store</span>():<span class="built_in">haveValue</span>(<span class="literal">false</span>)&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>调用类模板</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Store&lt;<span class="type">int</span>&gt; s1,s2;</span><br><span class="line">    s1.<span class="built_in">putElem</span>(<span class="number">3</span>);</span><br><span class="line">    s2.<span class="built_in">putElem</span>(<span class="number">4</span>);</span><br><span class="line">    cout &lt;&lt; s1.<span class="built_in">getElem</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="线性群体"><a href="#线性群体" class="headerlink" title="线性群体"></a>线性群体</h3><p>群体的概念</p>
<ul>
<li><code>群体</code>是指由多个数据元素组成的集合体<br>  群体可以分为两个大类：<code>线性群体</code>和<code>非线性群体</code></li>
<li><code>线性群体</code>中的元素按位置排列有序<br>  可以分为第一个元素，第二个元素等</li>
<li><code>非线性群体</code>不用位置顺序来标识元素</li>
</ul>
<p>线性群体中的元素次序和逻辑位置关系是对应的。按照访问元素的不同方法分为<code>直接访问</code>,<code>顺序访问</code>和<code>索引访问</code></p>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>直接访问的线性群体–数组类</p>
<ul>
<li>静态数组是具有固定元素个数的群体，其中的元素可以通过下标直接访问。</li>
<li>缺点：大小在编译时确定，在运行时无法修改</li>
<li>动态数组由一系列位置连续的，任意数量相同类型的元素组成</li>
<li>优点：其元素个数可在程序运行时改变</li>
</ul>
<h3 id="链表类"><a href="#链表类" class="headerlink" title="链表类"></a>链表类</h3><p>链表是一种动态数据结构，可以用来表示顺序访问的线性群体<br>链表是由系列结点组成的，结点可以在运行时动态生成<br>每一个结点包括数据域和指向链表中下一个结点的指针<br>如果链表每个结点只有一个指向后继结点的指针，则为单链表</p>
<p>单链表结点模板</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        Node&lt;T&gt; *next;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        T data;</span><br><span class="line">        <span class="built_in">Node</span>(<span class="type">const</span> T&amp; item, Node&lt;T&gt;* next = <span class="number">0</span>);</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">insertAfter</span><span class="params">(Node&lt;T&gt; *p)</span></span>;</span><br><span class="line">        <span class="function">Node&lt;T&gt; *<span class="title">deleteAfter</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function">Node&lt;T&gt; *<span class="title">nextNode</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="type">void</span> Node&lt;T&gt;::<span class="built_in">insertAfter</span>(Node&lt;T&gt; *p) &#123;</span><br><span class="line">    p-&gt;next = next;</span><br><span class="line">    next = p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line">Node&lt;T&gt;* Node&lt;T&gt;::<span class="built_in">deleteAfter</span>() &#123;</span><br><span class="line">    Node&lt;T&gt; *tempPtr = next;</span><br><span class="line">    <span class="keyword">if</span> (next == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    next = tempPtr-&gt;next;</span><br><span class="line">    <span class="keyword">return</span> tempPtr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h2><h3 id="链表类模板"><a href="#链表类模板" class="headerlink" title="链表类模板"></a>链表类模板</h3><p>链表的基本操作</p>
<ul>
<li>生成链表</li>
<li>插入结点</li>
<li>查找结点</li>
<li>删除结点</li>
<li>遍历链表</li>
<li>清空链表</li>
</ul>
<h3 id="栈类模板"><a href="#栈类模板" class="headerlink" title="栈类模板"></a>栈类模板</h3><h3 id="队列模板"><a href="#队列模板" class="headerlink" title="队列模板"></a>队列模板</h3><h3 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h3><p>每一步将一个待排序元素插入已排序序列的适当位置</p>
<h3 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h3><p>每次从待排序序列中选择一个最小的元素，顺序排在已排序序列的最后</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Thepatter"
      src="/images/header.jpeg">
  <p class="site-author-name" itemprop="name">Thepatter</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">207</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">83</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Thepatterraining" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Thepatterraining" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ztzhoutao041@163.com" title="E-Mail → mailto:ztzhoutao041@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://blog.csdn.net/Thepatterraining" title="CSDN → http:&#x2F;&#x2F;blog.csdn.net&#x2F;Thepatterraining" rel="noopener" target="_blank"><i class="fa fa-fw fa-CSDN"></i>CSDN</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Thepatter</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

        






<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"RWllimOI5okO7WFTUmJ4EeeD-gzGzoHsz","app_key":"hXeefwCw8aDKTJ1Xqye7fLYb","security":true};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'RWllimOI5okO7WFTUmJ4EeeD-gzGzoHsz',
      appKey     : 'hXeefwCw8aDKTJ1Xqye7fLYb',
      placeholder: "给我的文章加点评论吧~",
      avatar     : 'mp',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
