---
title: 学堂在线C++程序设计第五章学习笔记
date: 2021-07-21 10:12:47
tags: ['C++']
category: C++
article: 学堂在线C++程序设计第五章学习笔记
---

# 学堂在线C++程序设计第五章学习笔记

## 类与对象

对象：现实中对象的模拟，具有属性和行为。
类：同一类对象的共同属性和行为

定义对象时：通过构造函数初始化
删除对象时：通过析构函数释放资源

### 面向对象程序的基本特点

抽象：对同一类对象的共同属性和行为进行概括，形成类

封装：将抽象出的数据，代码封装在一起，形成类

继承：在已有类的基础上，进行扩展形成新的类

多态：同一名称，不同的功能实现方式

### 类和对象

设计类就是设计类型
- 此类型的“合法值”是什么
- 此类型应该有什么样的函数和操作符
- 新类型的对象该如何被创建和销毁
- 如何进行对象的初始化和赋值
- 对象作为函数的参数如何以值传递
- 谁将使用此类型的对象成员

类定义的语法形式
```C++
class 类名称
{
    public:
        公有成员（外部接口）
    private:
        私有成员
    protected:
        保护型成员
}
```

类的成员函数
- 在类中声明函数原型
- 可以在类外给出函数体实现，并在函数名前使用类名加以限定
- 也可以直接在类中给出函数体，形成内联成员函数
- 允许声明重载函数和带默认参数值得函数

### 构造函数

类中的特殊函数
用于描述初始化算法

作用：
- 在对象被创建时使用特定的值构造对象，将对象`初始化`为一个特定的初始状态

形式：
- 函数名与类名相同
- 不能定义返回值类型，也不能有return语句
- 可以有形式参数，也可以没有形式参数
- 可以是内联函数
- 可以重载
- 可以带默认参数值

调用时机
- 在对象创建时被自动调用
- 例如：
    Clock myClock(0,0,0)

默认构造函数
- 调用时可以不需要实参的构造函数
    - 参数表为空的构造函数
    - 全部参数都有默认值的构造函数

隐含生成的构造函数
- 如果程序中未定义构造函数，编译器将自动生成一个默认构造函数
- 参数列表为空，不为数据成员设置初始值
- 如果类内定义了成员的初始值，则使用内类定义的初始值
- 如果没有定义类内的初始值，则以默认方式初始化
- 基本类型的数据默认初始化的值是不确定的

复制构造函数
- 


## 共享数据的保护

常类型
- 常对象：必须进行初始化，不能被更新。
    const 类名 对象名
- 常成员：
    用 const 进行修饰的类成员：常数据成员和常函数成员
- 常引用：被引用的对象不能被更新
    const 类型说明符 &引用名；
- 常数组：数组元素不能被更新
    类型说明符 const 数组名[大小]
- 常指针：指向常量的指针


常成员：用const修饰的对象成员
- 常成员函数
    - 使用const 关键字说明的函数
    - 常成员函数不更新对象的数据成员
    - 常成员函数说明格式：
        类型说明符 函数名（参数表）const;
        这里，const是函数类型的一个组成部分，因此在实现部分也要带const关键字
    - const 关键字可以被用于参与对重载函数的区分
    - 通过常对象只能调用它的常成员函数
- 常数据成员
    - 使用 const 说明的数据成员


常引用
- 在友元函数中用常引用做参数，既能获得较高的执行效率，又能保证实参的安全性

## 多文件结构和预编译处理命令

C++程序的一般组织结构
- 一个工程可以划分为多个源文件
    - 类声明文件（.h文件）
    - 类实现文件（.cpp文件）
    - 类的使用文件（main()所在的.cpp文件）
- 利用工程来组合各个文件

文件1 Point.h

```C++
class Point{
    //类的定义
    public:
        Point(int x =0,int y = 0):x(x),y(y){}
        Point(const Point &p);
        static void showCount();
    private:
        int x,y;
        static int count;
}
```

文件2 Point.cpp

```C++
#include "Point.h"
#include <iostream>
using namespace std;

int Point::cout = 0;

Point::Point(const Point &p):x(p.x),y(p.y){
    count++;
}

void Point::showCount() {
    cout << "Object count =" << count << endl;
}
```

文件3 主函数 main.cpp

```C++
#include "Point.h"
#include <iostream>
using namespace std;

int main() {
    Point a(4,5);
    cout << "Point A:" < a.getX() << "," << a.getY();
    Point::showCount();
    Point b(a);
    cout << "Point B:" << b.getX() << "," << b.getY();
    Point::showCount();
    return 0;
}
```

外部变量
- 除了在定义它的源文件中可以使用外，还能被其他文件使用
- 文件作用域中定义的变量，默认情况下都是外部变量
- 在其它文件中如果需要使用，需要用extern关键字声明

外部函数
- 在所有类之外声明的函数（也就是非成员函数），都是具有文件作用域的
- 这样的函数都可以在不同的编译单元中被调用
- 只要在调用之前进行引用性声明（即声明函数原型）即可

将变量和函数限制在编译单元内
- 在匿名命名空间中定义的变量和函数，都不会暴露给其它的编译单元

```C++
namespace {
    //匿名的命名空间
    int n;
    void f() {
        n++;
    }
}
```

标准C++库
- 标准C++类库是一个极为灵活并可扩展的可重用软件模块的集合

标准C++类与组件在逻辑上分为6种类型：
- 输入/输出类
- 容器类与抽象数据类型
- 存储管理类
- 算法
- 错误处理
- 运行环境支持

编译预处理
- #include 包含指令
    - 将一个源文件嵌入到当前源文件中该点处
    - #include<文件名>
        - 按标准方式搜索，文件位于C++系统目录的include子目录下
    - #include "文件名"
        - 首先在当前目录中搜索，若没有，再按标准方式搜索
- #define 宏定义指令
    - 定义符号常量，很多情况下已被const定义语句取代
    - 定义带参数宏，已被内联函数取代
- #under
    - 删除由 #define 定义的宏，使之不再起作用


条件编译指令  #if 和 #endif
#if 常量表达式
    //当 常量表达式 非零时编译
    程序正文
#endif

条件编译指令 #else
#if 常量表达式
    //当 常量表达式 非零时编译
    程序正文1
#else
    //当 常量表达式 为零时编译
    程序正文2
#endif

条件编译指令 #elif
#if 常量表达式1
    //当 常量表达式1 非零时编译
    程序正文1
#elif 常量表达式2
    //当 常量表达式2 非零时编译
    程序正文2
#else
    //其他情况下编译
    程序正文3
#endif

条件编译指令
#ifdef 标识符
    程序段1
#else
    程序段2
#endif

- 如果 `标识符` 经 #define 定义过，且未经undef删除，则编译程序段1
- 否则编译程序段2

条件编译指令
#ifndef 标识符
    程序段1
#else 
    程序段2
#endif

- 如果`标识符`未被定义过，则编译程序段1
- 否则编译程序段2


